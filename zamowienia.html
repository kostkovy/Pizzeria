<!DOCTYPE html>
<html lang="PL-pl">
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Pizzeria Podpłomień! Najlepsza pizza w internecie!</title>
    <link rel="icon" type="image/x-icon" href="src/favicon.ico">
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='style.css'>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    </head>
<body>
    <header>
        <div id="logo">Pizzera Podpłomień
        <img src="src/img/logo.png" height="50px" width="50px" alt="pizza_photo">
        </div>
        <div id="logo"><a href="menu.html">Menu</a></div>
        <div id="logo"><a href="stworz.html">Dark Mode</a></div>
    </header>

    <div class="wiersz">
        </div>

    <article id="intro">
        Witamy w pizzeri.
    </article>

    <div style="text-align: center; margin-top: 50px;">
        <h2>Twoja Pepperoni Pizza (na Canvasie!)</h2>
        <canvas id="pepperoniPizzaCanvas" width="400" height="400" style="border: 1px solid #ccc; background-color: #f0f0f0;"></canvas>
    </div>

    <script>
     document.addEventListener('DOMContentLoaded', function() {
    const canvas = document.getElementById('pepperoniPizzaCanvas');
    const ctx = canvas.getContext('2d');

    // Lista składników z obrazkami
    const ingredients = {
        pepperoni: { name: 'Pepperoni', img: 'src/img/peperoni.png' },
        ham: { name: 'Szynka', img: 'src/img/ingredients/ham.png' },
        garlic: { name: 'Czosnek', img: 'src/img/ingredients/garlic.png' },
        onion: { name: 'Cebula', img: 'src/img/ingredients/onion.png' },
        corn: { name: 'Kukurydza', img: 'src/img/ingredients/corn.png' },
        pineapple: { name: 'Ananas', img: 'src/img/ingredients/pineapple.png' },
        olives: { name: 'Czarne oliwki', img: 'src/img/ingredients/olives.png' },
        jalapeno: { name: 'Jalapeno', img: 'src/img/ingredients/jalapeno.png' },
        chickenKebab: { name: 'Kebab z kurczaka', img: 'src/img/ingredients/chicken_kebab.png' },
        oregano: { name: 'Oregano', img: 'src/img/ingredients/oregano.png' },
        greenPepper: { name: 'Zielona papryka', img: 'src/img/ingredients/green_pepper.png' },
        mushrooms: { name: 'Pieczarki', img: 'src/img/ingredients/mushrooms.png' },
        roastedChicken: { name: 'Pieczony kurczak', img: 'src/img/ingredients/roasted_chicken.png' },
        cherryTomatoes: { name: 'Pomidorki koktajlowe', img: 'src/img/ingredients/cherry_tomatoes.png' }
    };

    // Konfiguracja pizzy
    const pizzaConfig = {
        pepperoni: localStorage.getItem("peperoni"),
        ham: 0,
        garlic: 0,
        onion: 0,
        corn: 0,
        pineapple: 0,
        olives: 0,
        jalapeno: 0,
        chickenKebab: 0,
        oregano: 0,
        greenPepper: 0,
        mushrooms: 0,
        roastedChicken: 0,
        cherryTomatoes: 0
    };

    // Ładowanie obrazka
    function loadImage(src) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            img.onload = () => resolve(img);
            img.onerror = reject;
            img.src = src;
        });
    }

    // Generowanie pozycji składników
    function generatePositions(count, minRadius = 50, maxRadius = 160, minDistance = 30) {
        const positions = [];
        const center = { x: 200, y: 200 };
        
        while (positions.length < count) {
            const angle = Math.random() * Math.PI * 2;
            const distance = minRadius + Math.random() * (maxRadius - minRadius);
            
            const x = center.x + Math.cos(angle) * distance;
            const y = center.y + Math.sin(angle) * distance;
            
            let validPosition = true;
            for (const pos of positions) {
                const dx = pos.x - x;
                const dy = pos.y - y;
                const dist = Math.sqrt(dx * dx + dy * dy);
                
                if (dist < minDistance) {
                    validPosition = false;
                    break;
                }
            }
            
            if (validPosition) {
                positions.push({ 
                    x: x, 
                    y: y,
                    size: 20 + Math.random() * 10 // losowy rozmiar
                });
            }
        }
        
        return positions;
    }

    // Rysowanie podstawy pizzy (zachowane z oryginalnego kodu)
    function drawPizzaBase() {
        // Ciasto
        ctx.beginPath();
        ctx.fillStyle = '#f5d742';
        ctx.arc(200, 200, 180, 0, Math.PI * 2);
        ctx.fill();
        
        // Brzeg pizzy
        ctx.beginPath();
        ctx.strokeStyle = '#d4a42c';
        ctx.lineWidth = 15;
        ctx.arc(200, 200, 180, 0, Math.PI * 2);
        ctx.stroke();
    }

    // Rysowanie sosu pomidorowego (zachowane z oryginalnego kodu)
    function drawTomatoSauce() {
        ctx.beginPath();
        ctx.fillStyle = '#d62828';
        ctx.arc(200, 200, 165, 0, Math.PI * 2);
        ctx.fill();
    }

    // Rysowanie sera (zachowane z oryginalnego kodu)
    function drawCheese() {
        ctx.beginPath();
        ctx.fillStyle = 'rgba(255, 255, 0, 0.4)';
        ctx.arc(200, 200, 160, 0, Math.PI * 2);
        ctx.fill();
    }

    // Rysowanie składników z obrazków
    async function drawIngredients() {
        for (const [ingredient, count] of Object.entries(pizzaConfig)) {
            if (count > 0 && ingredients[ingredient]) {
                try {
                    const img = await loadImage(ingredients[ingredient].img);
                    const positions = generatePositions(count);
                    
                    positions.forEach(pos => {
                        const size = pos.size;
                        ctx.drawImage(img, pos.x - size/2, pos.y - size/2, size, size);
                    });
                } catch (error) {
                    console.error(`Błąd ładowania obrazka dla ${ingredient}:`, error);
                }
            }
        }
    }

    // Rysowanie linii cięcia (zachowane z oryginalnego kodu)
    function drawSlices() {
        ctx.beginPath();
        ctx.strokeStyle = '#000';
        ctx.lineWidth = 1;
        for(let i = 0; i < 8; i++) {
            const angle = (i * Math.PI / 4);
            ctx.moveTo(200, 200);
            ctx.lineTo(200 + Math.cos(angle) * 180, 200 + Math.sin(angle) * 180);
        }
        ctx.stroke();
    }

    // Główna funkcja rysująca pizzę
    async function drawPizza() {
        drawPizzaBase();
        drawTomatoSauce();
        drawCheese();
        await drawIngredients();
        drawSlices();
    }

    drawPizza();
});
    </script>
</body>
</html>